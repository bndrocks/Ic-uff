<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8">
  <title>Home</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="style.css">
  <link href="assets/css/uicons-regular-rounded.css" rel="stylesheet">
  <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
</head>

<body class="fonte">
  <div class="container-login">
    <img src="imagens/usuario.png">
    <div id = "formInicial">
      <div><button class="button" onclick="mostraLogin()">Logar</button></div>
      <div><button class="button" onclick="mostraCadastro()">Cadastrar</button></div>
    </div>
    <div id = "formLogin" style="display: none;">
      <div><input class="email" type="text" name="email" id="email-login" placeholder="Digite seu e-mail"></div>
      <div><input class="senha" type="password" name="senha" id="senha-login" placeholder="Digite sua senha"></div>
      <div><button class="button" onclick="login()">Logar</button></div>
      <div class="container-links">
        <a class="links" onclick="esqueciSenha()">Esqueceu sua senha?</a>
        <a class="links" onclick="mostraCadastro()">Criar uma conta</a>
        <!--img src="../imagens/criar-conta.png"-->
      </div>
      <div><button class="button" onclick="volta()">Voltar</button></div>
    </div>
    <div id = "formCadastro" style="display: none;">
      <div><input class="nome" type="text" name="nome" id="nome-cadastro" placeholder="Digite seu nome"></div>
      <div><input class="email" type="text" name="email" id="email-cadastro" placeholder="Digite seu e-mail"></div>
      <div><input class="senha" type="password" name="senha" id="senha-cadastro" placeholder="Digite sua senha"></div>
      <small>Aluno ou Professor</small>
      <div class="flex flex-wrap justify-center">
        <div>
          <input class="tipo" type="radio" name="tipo" id="tipo-aluno">
          <label for="aluno">Aluno</label>
        </div>
        <div>
          <input class="tipo" type="radio" name="tipo" id="tipo-prof">
          <label for="professor">Professor</label>
        </div>
      </div>
      <div><button class="button" onclick="cadastro()">Cadastrar</button></div>
      <div><button class="button" onclick="volta()">Voltar</button></div>
    </div>
  </div>
  <script>
    function mostraLogin(){
      document.getElementById("formLogin").style.display = "inline";
      document.getElementById("formInicial").style.display = "none";
    }
    function mostraCadastro(){
      document.getElementById("formLogin").style.display = "none";
      document.getElementById("formCadastro").style.display = "inline";
      document.getElementById("formInicial").style.display = "none";
    }
    function volta(){
      document.getElementById("formLogin").style.display = "none";
      document.getElementById("formCadastro").style.display = "none";
      document.getElementById("formInicial").style.display = "inline";
    }
    function cadastro(){
      let data = {};
      data.nome = document.getElementById("nome-cadastro").value;
      data.email = document.getElementById("email-cadastro").value;
      //data.tipo = document.getElementById("tipo-cadastro").value;
      data.senha = document.getElementById("senha-cadastro").value;
      axios.post('http://localhost:3003/usuario/cadastro', data)
        .then(function (response) {
          console.log(response);
        })
        .catch(function (error) {
          console.log(error);
        });
    }
    function login(){
      let data = {};
      data.email = document.getElementById("email-login").value;
      data.senha = document.getElementById("senha-login").value;
      axios.post('http://localhost:3003/usuario/login', data)
        .then(function (response) {
          console.log(response);
          if (response.statusText == 'Logado') {
            if(contErroLogin > 0)
              removerElemento('erro-login');
            localStorage.setItem('logado', true);
            //salvar dados do usuario
            localStorage.setItem('nome', response.data.user.nome);
            localStorage.setItem('email', response.data.user.email);
            //localStorage.setItem('tipo', response.data.user.tipo);
          }
          else {
            contErroLogin++;
            if (contErroLogin > 1) {
              removerElemento('erro-login');
              criarElementoErroLogin(response.data.data);
            }
            else
              criarElementoErroLogin(response.data.data);
          }
        })
        .catch(function (error) {
          console.log(error);
        });
    }

  </script>
</body>
</html>